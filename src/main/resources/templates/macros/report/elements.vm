#macro(includeElements, $elements, $linkToFeature)

#foreach($element in $elements)
  <div class="element">
    #if($linkToFeature)
      <div class="indention">
        <a href="$element.getFeature().getReportFileName()">View Feature</a> <i>$element.getFeature().getName()</i>
      </div>
    #end
    #includeTags($element.getTags())

    <span data-toggle="collapse" class="#if($element.getStatus().isPassed()) collapsed #end collapsable-control" data-target="#element-$element.hashCode()">
      #includeBrief($element.getKeyword(), $element.getStatus(), $element.getName(), true)
    </span>
    <div class="description indention">$element.getDescription()</div>

    <span id="element-$element.hashCode()" class="collapse collapsable-details #if(!$element.getStatus().isPassed()) in #end">
      #includeHooks("Before", $element.getBefore())

      <div class="steps inner-level">
        #foreach($step in $element.getSteps())
          <div class="step">
            #includeBrief($step.getKeyword(), $step.getStatus(), $step.getName(), false, $step.getResult())
            #includeMessage($step.getErrorMessage())

            #if($step.hasRows())
              <table class="arguments-table">
                #foreach($row in $step.getRows())
                  <tr>
                    #foreach($cell in $row.getCells())
                      <td>$cell</td>
                    #end
                  </tr>
                #end
              </table>
            #end

            #includeMessage($step.getOutput(), "output")
            #if(!$step.getAttachments().isEmpty())
              <div class="embeddings inner-level">
                $step.getAttachments()
              </div>
            #end
          </div>
        #end
      </div>

      #includeHooks("After", $element.getAfter())
    <span>
  </div>
#end

#end
